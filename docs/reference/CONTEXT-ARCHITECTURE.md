# Context Architecture Guide

**Purpose:** Reference document mapping the marketing organization's context and memory system.

---

## Context System Overview

The context system is organized in 5 layers, from configuration to operational knowledge:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         CONTEXT LAYERS                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ LAYER 1: CLAUDE.md                                              │   │
│  │ Central config • Command reference • Pointers                    │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ LAYER 2: client-context/                                        │   │
│  │ Brand architecture • Voice guides • Customer profiles           │   │
│  │ Company profile • Competitor intelligence                       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ LAYER 3: content/                                               │   │
│  │ Content bank • Working drafts • Theme tracking                  │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ LAYER 4: .claude/skills/ + hooks/                               │   │
│  │ Workflows • Lifecycle hooks • Operational procedures            │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              ↓                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │ LAYER 5: docs/reference/                                        │   │
│  │ Guidelines • Technical schemas • User guides                    │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Data Flow: Local → Airtable → External

```
LOCAL CONTEXT                    AIRTABLE                     EXTERNAL
┌────────────────────┐          ┌─────────────────┐          ┌─────────────┐
│ content-bank.md    │  Push →  │ Content         │  Sync →  │ Dashboard   │
│ ├── Themes         │          │ Calendar        │          │ Review UI   │
│ ├── Status tracking│          │                 │          │ Approvals   │
│ └── Record ID links│  ← Pull  │                 │  ← Pull  │ Feedback    │
└────────────────────┘          └─────────────────┘          └─────────────┘
       ↑                               ↑
       │                               │
       └──── Manual update ────────────┘
             (Record IDs)
```

**Key Principle:** Content development stays local. Airtable shows only scheduled/active posts.

---

## Complete File Index

### Layer 1: Central Configuration

| File | Purpose | Key Contents |
|------|---------|--------------|
| `CLAUDE.md` | System entry point | Commands, quick reference |

### Layer 2: Brand Intelligence (`client-context/`)

Generated by `/onboard` command:

| File | Purpose |
|------|---------|
| `brand/brand-architecture-framework.md` | StoryBrand framework, positioning |
| `brand/messaging-framework.md` | Core messages, elevator pitches |
| `brand/voice-and-tone-guide.md` | Voice pillars, tone adjustments |
| `business/company-profile.md` | Company overview, leadership, goals |
| `business/IDEAL-CLIENT-PROFILE-ICP.md` | Target client definition |
| `business/customer-profiles/*.md` | Detailed customer segments |
| `competitors/differentiation-strategy.md` | Competitive positioning |
| `templates/*.md` | Templates for customization |

### Layer 3: Working Content (`content/`)

| File | Purpose | Status |
|------|---------|--------|
| `social/content-bank.md` | Theme bank, status tracking, voice profiles | Active |

### Layer 4: Operational Skills (`.claude/skills/`) & Hooks (`.claude/hooks/`)

| File | Purpose | Type |
|------|---------|------|
| `social-content-workflow.md` | Complete social workflow | Workflow |
| `images/SKILL.md` | AI image generation toolkit (`/images`) | Skill |
| `social-intel/SKILL.md` | Social media intelligence (`/intel`) | Skill |
| Various design/marketing skills | Specialized capabilities | Skills |

| Hook | Event | Purpose |
|------|-------|---------|
| `.claude/hooks/check-onboarding.sh` | SessionStart | Detects missing brand config, prompts `/onboard` |
| `.claude/hooks/save-session-ledger.sh` | SessionEnd | Appends session metadata to intelligence ledger |

Hook configuration lives in `.claude/settings.json`.

### Layer 5: Reference Documentation (`docs/reference/`)

| File | Purpose | Type |
|------|---------|------|
| `social-content-rules.md` | Content guidelines | Rules |
| `competitive-win-themes.md` | Win themes | Strategy |
| `technical/airtable-schema-template.md` | Airtable field reference | Technical |
| `user-guides/*.md` | How-to guides | Guide |

### Cross-Session Memory & Intelligence (`docs/intelligence/`)

| File | Purpose | Status |
|------|---------|--------|
| `internal/context-intelligence-ledger.md` | Session memory, performance tracking | Auto-generated by SessionEnd hook |
| `linkedin/competitor-posts.json` | Competitor post data from LinkedIn | Generated by `/intel` |
| `twitter/industry-themes.json` | Industry themes from Twitter/X | Generated by `/intel` |
| `visuals/style-patterns.json` | Visual pattern analysis | Generated by `/intel` |
| `synthesis/image-generation-intel.json` | Synthesis for image generation prompts | Generated by `/intel` |

---

## Quick Reference: "Where Do I Find...?"

| Looking For... | Go To |
|----------------|-------|
| **Voice profiles (all team)** | `client-context/brand/voice-and-tone-guide.md` |
| **Partner voice template** | `expansions/partner-voice-template/` |
| **Social content workflow** | `.claude/skills/social-content-workflow.md` |
| **Content themes to use** | `content/social/content-bank.md` |
| **Competitive win themes** | `docs/reference/competitive-win-themes.md` |
| **Full competitor analysis** | `client-context/competitors/differentiation-strategy.md` |
| **Image generation commands** | `.claude/skills/images/SKILL.md` |
| **Social intelligence** | `.claude/skills/social-intel/SKILL.md` |
| **Intel synthesis data** | `docs/intelligence/synthesis/image-generation-intel.json` |
| **Customer segments** | `client-context/business/customer-profiles/` |
| **Brand architecture** | `client-context/brand/brand-architecture-framework.md` |
| **Airtable field schemas** | `docs/reference/technical/airtable-schema-template.md` |
| **Company overview** | `client-context/business/company-profile.md` |
| **Hook configuration** | `.claude/settings.json` |
| **Hook scripts** | `.claude/hooks/` |

---

## Airtable Integration Reference

### Base & Table IDs

Configure these during `/onboard`:

| Resource | ID |
|----------|-----|
| **Base ID** | `[Configure in /onboard]` |
| **Content Calendar** | `[Configure in /onboard]` |

### Sync Workflow

```
1. CREATE CONTENT (local)
   └── Check content-bank.md for AVAILABLE themes
   └── Apply voice profile + quality filter

2. PUSH TO AIRTABLE
   └── Set required fields: Date, Post Topic, Posting Account, Platform, Copy
   └── Set statuses: Copy Status = "Approved", Post Status = "Scheduled"

3. UPDATE CONTENT BANK
   └── Mark theme status: AVAILABLE → PUBLISHED
   └── Add Airtable record ID

4. AFTER POSTING
   └── Update theme status as needed
   └── Add posted date
```

### Sync Status Tracking

The `content-bank.md` file uses these statuses:

| Status | Meaning |
|--------|---------|
| `AVAILABLE` | Ready to develop into copy |
| `DRAFTED` | Copy written, not in Airtable |
| `IN_AIRTABLE` | Pushed, awaiting posting |
| `POSTED` | Published with date |
| `EVERGREEN` | Can be reused/adapted |

---

## Content Pipeline Architecture

### Voice Profiles by Account

Configure during `/onboard`:

| Account | Voice Reference | Cadence |
|---------|-----------------|---------|
| Partner accounts | `expansions/partner-voice-template/` (customize) | Configure per partner |
| Company account | `client-context/brand/voice-and-tone-guide.md` | Configure per brand |

### Content Pillars

Define during `/onboard`:

| Pillar | Use For |
|--------|---------|
| **Thought Leadership** | Expert insights |
| **Customer Success** | Case studies |
| **Educational** | How-to content |
| **Culture** | Team/company stories |

---

## Cross-Session Memory Model

### Current Implementation

The system uses **file-based context** with automatic session tracking:

- Each session re-reads files from scratch
- **SessionEnd hook** automatically appends session metadata to the intelligence ledger
- **SessionStart hook** checks for brand configuration and prompts `/onboard` if missing
- Intelligence ledger accumulates learnings across sessions
- Context is reconstructed from files each session

### Memory Continuity Pattern

```
Session N                           Session N+1
┌─────────────────────┐            ┌─────────────────────┐
│ Read context files  │            │ Read context files  │
│         ↓           │            │         ↓           │
│ Execute operations  │            │ Execute operations  │
│         ↓           │            │         ↓           │
│ Update ledger with  │─────────→ │ Ledger informs      │
│ learnings/insights  │            │ decisions           │
└─────────────────────┘            └─────────────────────┘
```

---

## Context Health Checklist

Use this checklist to verify context completeness:

### Essential Files (Must Exist)

- [ ] `CLAUDE.md` - Central configuration
- [ ] `.claude/settings.json` - Hook configuration
- [ ] `content/social/content-bank.md` - Theme bank
- [ ] `.claude/skills/social-content-workflow.md` - Workflow
- [ ] `client-context/brand/voice-and-tone-guide.md` - All voices

### Brand Context (Must Be Current)

- [ ] `client-context/brand/brand-architecture-framework.md`
- [ ] `client-context/brand/messaging-framework.md`
- [ ] `client-context/business/company-profile.md`
- [ ] `client-context/competitors/differentiation-strategy.md`

---

## Maintenance Guidelines

### Daily

- Update content-bank.md when themes are used
- Add record IDs after Airtable pushes

### Weekly

- Review content status for completeness
- Check for status drift

### Monthly

- Audit content-bank sync accuracy
- Review intelligence ledger for actionable insights
- Update competitive themes if market shifts

### Quarterly

- Full brand context review
- Update customer profiles based on performance data

---

## Related Documentation

| Document | Purpose |
|----------|---------|
| `CLAUDE.md` | System entry point |
| `.claude/settings.json` | Hook configuration (SessionStart, SessionEnd) |
| `client-context/README.md` | Brand documentation hub |
| `.claude/skills/social-content-workflow.md` | Complete workflow reference |

---

*This document is the reference for context architecture. Update this file when adding new context locations or changing the architecture.*
